*{
  margin: 0;
  padding: 0;
  user-select: none;
  cursor: auto;
  box-sizing: border-box;
  
}

html, body {
  height: 100%;
  overflow: hidden;
  touch-action: manipulation;
  overscroll-behavior: none;
}

body {
  margin: 0;
  background: #ffeaf6;
  font-family: 'Poppins', sans-serif;
}

.author {
  font-size: clamp(22px, 5vw, 34px);
  margin-top: 15px;
  color: #333;
  font-weight: 600;
  letter-spacing: 2px;
  text-shadow: 0 3px 8px rgba(0,0,0,0.15);
}

.page {
  width: 100%;
  height: 100%;
  position: absolute;
  transform-style: preserve-3d;
  transform-origin: left;
  transition: transform 1.2s ease-in-out;
  cursor: pointer;
  border: 3px solid #888;
  border-radius: 10px;
  box-shadow: 0 4px 12px rgba(0,0,0,0.2);
  background: white;
}

.page .front img,
.page .back img {
  width: 100%;
  height: 90%;
  object-fit: cover;
  border: 2px solid #444;
  border-radius: 6px;
  box-sizing: border-box;
}

.page .back {
  transform: rotateY(180deg);
}

.page .back .photo-date {
  transform: rotateY(180deg);
  text-align: center;
  backface-visibility: hidden;
}

.page.flipped {
  transform: rotateY(-180deg) rotateX(3deg);
}

.intro-content, .end-content {
  text-align: center;
  border: 3px solid black;
  padding: 10px;
  border-radius: 15%;
}

.intro-content h1 {
  font-size: clamp(40px, 10vw, 70px);
  color: #fb18c2;
  margin-bottom: 15px;
  text-shadow: 0 4px 10px rgba(251, 24, 194, 0.3);
}

.intro-content p {
  font-size: clamp(22px, 6vw, 32px);
  line-height: 1.8;
  color: #555;
  line-height: 1.6;
}

.intro-content,.end-content {
  background: linear-gradient(135deg, #f5f7fa, #e0e4e8);
  width: 100%;
  height: 100%;
  border-radius: 6px;
  display: flex;
  flex-direction: column;
  justify-content: center;
  align-items: center;
}

.end-content h2 {
  font-family: 'Pacifico', cursive;
  font-size: clamp(20px, 5vw, 24px);
  margin-bottom: 14px;
  color: #333;
}

.end-content span {
  font-size: clamp(14px, 3.8vw, 17px);
  color: #444;
  line-height: 1.6;
}

.caption {
  margin-top: 18px;
  font-size: 20px;
  color: #555;
  text-align: center;
  z-index: 10;
  flex-shrink: 0;
}
  
.page .front,
.page .back {
  position: absolute;
  width: 100%;
  height: 100%;
  backface-visibility: hidden;
  overflow: hidden;

  display: flex;
  flex-direction: column;
  justify-content: flex-start;
  align-items: center;

  padding: 20px;
  box-sizing: border-box;
}

.book {
  position: absolute;
  left: 50%;
  top: 50%;
  transform: translate(-50%, -50%);
  width: min(85vw, 750px);  /* giáº£m vw xuá»‘ng */
  aspect-ratio: 3 / 4;  /* giá»¯ tá»‰ lá»‡ Ä‘áº¹p */
  perspective: 2000px;
  z-index: 1;
}

/* ===== LOCK SCREEN STYLE FINAL ===== */

#lock-screen-1,
#lock-screen-2,
#lock-screen-3 {
  position: fixed;
  inset: 0;
  min-height: 100dvh;
  display: flex;
  justify-content: center;
  align-items: center;
  background: #f3d6dc;
  padding: 20px;
  z-index: 9999;
}

.lock-wrapper {
  width: 100%;
  max-width: 320px;

  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 18px;   /* ğŸ‘ˆ thÃªm dÃ²ng nÃ y */
}

.lock-wrapper h2 {
  text-align: center;
  line-height: 1.4;
  height: 110px;      /* ğŸ‘ˆ Ä‘á»•i thÃ nh height cá»‘ Ä‘á»‹nh */
}

.lock-wrapper h2 span {
  display: block;
  margin-top: 6px;
}

/* TiÃªu Ä‘á» */
#lock-screen-1 h2,
#lock-screen-2 h2,
#lock-screen-3 h2 {
  font-family: sans-serif;
  font-size: 18px;
  font-weight: bold;
  letter-spacing: 1px;
  color: #e75480;
  margin-bottom: 8px;
}

/* Ã” nháº­p pass */
.password-input {
  width: 100%;
  height: 42px;
  border-radius: 12px;
  border: none;
  outline: none;
  padding: 0 10px;
  font-size: 14px;
  text-align: center;
  background: #eeeeee;
}

/* Keypad */
.keypad {
  display: grid;
  grid-template-columns: repeat(3, 1fr);
  gap: 16px;
  width: 100%;
  max-width: 280px;  /* ğŸ‘ˆ thÃªm dÃ²ng nÃ y */
}

/* NÃºt sá»‘ */
.keypad button {
  width: 100%;
  aspect-ratio: 1 / 1;  /* ğŸ‘ˆ lÃ m thÃ nh hÃ¬nh vuÃ´ng */
  border-radius: 20px;
  border: none;
  background: #f9f9f9;
  color: #444;
  font-size: 20px;
  font-weight: 500;
  font-family: 'Poppins', sans-serif;

  display: flex;
  justify-content: center;
  align-items: center;

  box-shadow:
    0 8px 20px rgba(0,0,0,0.08),
    inset 0 -2px 4px rgba(0,0,0,0.04);

  transition: all 0.2s ease;
}

.keypad button:active {
  transform: scale(0.93);
  box-shadow:
    0 4px 10px rgba(0,0,0,0.12),
    inset 0 2px 4px rgba(0,0,0,0.08);
}

/* NÃºt X */
.keypad .delete {
  background: linear-gradient(135deg, #ff6b9a, #e75480);
  color: white;
  font-weight: bold;
  box-shadow: 0 8px 18px rgba(231,84,128,0.4);
}

/* NÃºt xÃ¡c nháº­n */
.submit-btn {
  width: 70px;
  height: 70px;
  border-radius: 50%;
  border: none;

  display: flex;
  justify-content: center;
  align-items: center;

  background: linear-gradient(135deg, #ff6b9a, #e75480);
  color: white;
  font-size: 24px;
  box-shadow: 0 10px 25px rgba(231,84,128,0.45);
}

.submit-btn:active {
  transform: scale(0.92);
}

/* ===== INPUT STYLE ===== */
input {
  transition: all 0.3s ease;
}

.input-error {
  border: 2px solid #ff4d4d;
  background: #ffe5e5;
}

.input-success {
  border: 2px solid #4CAF50;
  background: #e8fbe8;
}

/* ===== SHAKE ===== */
@keyframes shake {
  0% { transform: translateX(0); }
  20% { transform: translateX(-8px); }
  40% { transform: translateX(8px); }
  60% { transform: translateX(-6px); }
  80% { transform: translateX(6px); }
  100% { transform: translateX(0); }
}

.shake {
  animation: shake 0.4s;
}

/* ===== BIG UNLOCK OVERLAY ===== */

#unlock-overlay {
  position: fixed;
  inset: 0;
  background: rgba(0,0,0,0.55);
  display: none;
  justify-content: center;
  align-items: center;
  z-index: 20000;

  perspective: 1500px;   /* ğŸ‘ˆ THÃŠM DÃ’NG NÃ€Y */
}

.big-lock {
  position: relative;
  width: 160px;
  height: 160px;
  transform-style: preserve-3d;
  will-change: transform;
}

.big-lock .front {
  position: absolute;
  width: 100%;
  height: 100%;
  font-size: 150px;
  display: flex;
  justify-content: center;
  align-items: center;
  backface-visibility: hidden;

  transform: rotateY(0deg) translateZ(2px); /* ğŸ‘ˆ thÃªm dÃ²ng nÃ y */
}

.big-lock .back {
  position: absolute;
  width: 100%;
  height: 100%;
  font-size: 150px;
  display: flex;
  justify-content: center;
  align-items: center;
  backface-visibility: hidden;

  transform: rotateY(180deg) translateZ(2px); /* ğŸ‘ˆ thÃªm translateZ */
}

/* Xoay á»• khÃ³a */
@keyframes lockSpin {
  0% {
    transform: rotateY(0deg);
  }
  100% {
    transform: rotateY(1800deg); /* 5 vÃ²ng */
  }
}

.spin {
  animation: lockSpin 2s ease-out forwards;
}

/* Khi má»Ÿ */
.open {
  animation: popOpen 0.4s ease forwards;
}

@keyframes popOpen {
  0% {
    transform: rotateY(1800deg) scale(1);
  }
  60% {
    transform: rotateY(1800deg) scale(1.6);
  }
  100% {
    transform: rotateY(1800deg) scale(1.3);
  }
}

js nÃ¨ 
const book = document.getElementById('book');
const pages = [];
const sound = document.getElementById("sound");

document.addEventListener("click", () => {
  if (sound.paused) {
    sound.currentTime = 0;
   // sound.addEventListener("pause", () => {
   // setTimeout(() => {
   // sound.play().catch(() => {});
   //  }, 500); 
   //  });
    sound.play().catch(err => console.log("KhÃ´ng phÃ¡t Ä‘Æ°á»£c nháº¡c:", err));
  }
}, { once: true });


const introPage = document.createElement('div');
introPage.className = 'page';
introPage.dataset.originalZ = 100;
introPage.style.zIndex = 100;

const introFront = document.createElement('div');
introFront.className = 'front';
introFront.innerHTML = `
  <div class="intro-content">
    <h1>Memory Album</h1>
    <div class="author"><em>BÃ¹i Ngá»c ThiÃªn HÆ°Æ¡ng ğŸ˜</em></div>
    <div>ğŸâ¤ï¸ğŸ</div>
  </div>
`;

const introBack = document.createElement('div');
introBack.className = 'back';

introPage.appendChild(introFront);
introPage.appendChild(introBack);
book.appendChild(introPage);
pages.push(introPage);

const images = [];
for (let i = 1; i <= 20; i++) { //Chá»‰nh sá»‘ lÆ°á»£ng áº£nh á»Ÿ Ä‘Ã¢y
  images.push(`./style/image/Anh (${i}).jpg`);
}

const dates = [
  "11-02-2026",
  "12-02-2026",
  "12-02-2026",
  "12-02-2026",
  "13-02-2026",
  "13-02-2026",
  "14-02-2026",
  "14-02-2026",
  "14-02-2026",
  "14-02-2026",
  "15-02-2026",
  "16-02-2026",
  "16-02-2026",
  "16-02-2026",
  "16-02-2026",
  "17-02-2026",
  "17-02-2026",
  "17-02-2026",
  "24-02-2026",
  "24-02-2026"
];

for (let i = 0; i < images.length; i++) {

  const page = document.createElement('div');
  page.className = 'page';
  const z = 99 - i;
  page.style.zIndex = z;

  const front = document.createElement('div');
  front.className = 'front';

  const back = document.createElement('div');
  back.className = 'back';

  // FRONT = TRANG BÃŠN PHáº¢I (cÃ³ áº£nh)
  const img = document.createElement('img');
  img.src = images[i];

  const caption = document.createElement('div');
  caption.className = 'caption';
  caption.innerText = dates[i] || "";

  front.appendChild(img);
  front.appendChild(caption);

  // BACK = TRANG BÃŠN TRÃI (trá»‘ng)
  // khÃ´ng thÃªm gÃ¬ vÃ o back

  page.appendChild(front);
  page.appendChild(back);
  book.appendChild(page);
  pages.push(page);
}

const endPage = document.createElement('div');
endPage.className = 'page';
endPage.dataset.originalZ = 0;
endPage.style.zIndex = 0;

const endFront = document.createElement('div');
endFront.className = 'front';
endFront.innerHTML = `
  <div class="end-content">
    <h2>â¤ï¸ I Love You â¤ï¸</h2>
    <span id="ending-text"></span>
  </div>
`;

const endBack = document.createElement('div');
endBack.className = 'back';
endBack.style.background = '#fff';

endPage.appendChild(endFront);
endPage.appendChild(endBack);
book.appendChild(endPage);
pages.push(endPage);

function typewriterEffect(text, element) {
  let i = 0;
  let slowRemaining = 0; // sá»‘ kÃ½ tá»± cÃ²n láº¡i cáº§n cháº¡y cháº­m

  function type() {
    if (i >= text.length) return;

    let speed = 80; // tá»‘c Ä‘á»™ bÃ¬nh thÆ°á»ng

    // Náº¿u báº¯t Ä‘áº§u cá»¥m "cÃ²n em"
    if (text.substring(i, i + 6) === "cÃ²n em") {
      slowRemaining = 6; // 6 kÃ½ tá»±: c Ã² n _ e m
    }

    // Náº¿u Ä‘ang trong cá»¥m cáº§n cháº¡y cháº­m
    if (slowRemaining > 0) {
      speed = 160; // tá»‘c Ä‘á»™ cháº­m cho toÃ n bá»™ "cÃ²n em"
      slowRemaining--;
    }

    // Náº¿u lÃ  dáº¥u ...
    if (text.substring(i, i + 3) === "...") {
      speed = 350;
    }

    element.innerHTML += text[i] === '\n' ? '<br>' : text[i];
    i++;

    setTimeout(type, speed);
  }

  type();
}

let currentTopZ = 200;
let typed = false;
let isFlipping = false; // thÃªm dÃ²ng nÃ y

pages.forEach((page) => {
  let startX = 0;
  const front = page.querySelector('.front');
  const back = page.querySelector('.back');

const flipForward = () => {
  if (isFlipping) return; // náº¿u Ä‘ang láº­t thÃ¬ cháº·n
  if (!page.classList.contains('flipped')) {

    isFlipping = true; // khÃ³a láº¡i

    page.classList.add('flipped');

    if (page === pages[pages.length - 2] && !typed) {
      const endText = document.getElementById('ending-text');
      const content = `A iu 3 thá»© trÃªn tháº¿ giá»›i nÃ y : 
        Máº·t trá»i (the Sun) â˜€ï¸, 
        Máº·t trÄƒg (the Moon)ğŸŒ•,
        VÃ  em (the Exception) â¤ï¸. 
        Máº·t trá»i lÃ  ...
        Ãnh sÃ¡g cá»§a ban mai ğŸŒ…,
        Máº·t trÄƒg lÃ  ...
        Váº» Ä‘áº¹p cá»§a mÃ n Ä‘Ãªm ğŸŒŒ,
        CÃ²n e lÃ  ğŸ¤” ... 
        LÃ  Ä‘á»‡ cá»¥a toi ğŸ˜
        Ã nháº§m, cÃ²n e lÃ  ğŸ¤” ... 
        LÃ  Ä‘Ã¬u ngá»t ngÃ o nhá»©t cá»§a a ğŸ˜˜
        { Háº¿t }`;
      endText.innerHTML = "";
      typewriterEffect(content, endText);
      typed = true;
    }

    setTimeout(() => {
      currentTopZ++;
      page.style.zIndex = currentTopZ;
      isFlipping = false; // má»Ÿ khÃ³a sau khi láº­t xong
    }, 1200); // 1000 pháº£i báº±ng thá»i gian animation CSS
  }
};

const flipBackward = () => {
  if (isFlipping) return;
  if (page.classList.contains('flipped')) {

    isFlipping = true;

    page.classList.remove('flipped');

    setTimeout(() => {
      currentTopZ++;
      page.style.zIndex = currentTopZ;
      isFlipping = false;
    }, 1200);
  }
};

  front.addEventListener('click', flipForward);
  back.addEventListener('click', flipBackward);

  page.addEventListener('touchstart', (e) => {
    startX = e.touches[0].clientX;
  });

  page.addEventListener('touchend', (e) => {
    const diff = e.changedTouches[0].clientX - startX;
    if (diff < -30) flipForward();
    else if (diff > 30) flipBackward();
  });

});

// Khi rá»i khá»i tab -> pause
document.addEventListener("visibilitychange", () => {
  if (document.hidden) {
    sound.pause();
  } else {
    sound.play().catch(() => {});
  }
});



